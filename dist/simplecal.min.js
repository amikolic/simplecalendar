(function(e,t,n){"use strict";function bt(t,n){this[r]=e.extend({},e[X][r],n);this.element=t;this[s]=e(t);if(this[r].disable_for_touch_devices&&this.is_touch_device&&this[s].attr("type")=="date")return;ut||(ut=e("body"));this.init()}var r="options",i="get_date_vars",s="$input",o="calendar_class",u="event_namespace",a="id_prefix",f="mobile_breakpoint",l="attached",c="length",h="</th>",p="generate_calendar_html",d="addClass",v=!1,m="<th>",g="month_change_class",y="input_val_backup",b="setup_markers",w="getFullYear",E="format_date",S="date_active_class",x='" data-current-month="',T="simplecal",N="-",C='" data-current-year="',k="month",L="getMonth",A="outerWidth",O="$el",M="removeClass",_='<a data-to-month="',D='<td><span class="',P="setup_position",H="opened",B='" data-to-year="',j="match",F="change",I="$attach_cont",q="</span></td>",R='_disabled">',U="getDate",z="</span></a>",W=!0,X="Simplecal",V="outerHeight",$="year",J='" class="',K="input_active_class",Q=null,G='"><span>',Y="close",Z="show_calendar",et="click",tt="trigger",nt="_invalid",rt="validate_input",it="_mobile",st=e(t),ot=e(n),ut=Q,at="ontouchstart"in t||"onmsgesturechange"in t,ft=0,lt={},ct=/,|\.|-| |\/|\\/,ht=/d/gi,pt=/m/gi,dt=/y/gi,vt=function(e){console.log(e)},mt=function(e,t){return e.toString()[c]>t?e:(new Array(t-e.toString()[c]+1)).join("0")+e},gt=function(e,t){return(new Date(t,e,0))[U]()},yt=function(e){var t=new Date(e[$],e[k]-1,e.day);return t&&t[L]()+1==e[k]&&t[U]()==Number(e.day)};bt[i]=function(e,t){var n,i,s,o,u;if(e instanceof Date)return{day:e[U](),month:e[L]()+1,year:e[w]()};t||(t=this[r].date_format);n=t[j](ct)[0];i={};s=e.split(n);o=t.split(n);if(s[c]!==3||o[c]!==3){vt("Simplecal: Error parsing date format");return v}for(u=0;u<3;u++){if(o[u][j](ht)){i.day=s[u];continue}if(o[u][j](pt)){i[k]=s[u];continue}o[u][j](dt)&&(i[$]=s[u])}if(!yt(i)){vt("Simplecal: Error date out of range");return v}return i};bt[E]=function(e,t){var n;e instanceof Date&&(e={day:e[U](),month:e[L]()+1,year:e[w]()});t||(t=this[r].date_format);n=t;n=n.replace(/d+/i,mt(e.day,n[j](ht)[c]));n=n.replace(/m+/i,mt(e[k],n[j](pt)[c]));n=n.replace(/y+/i,mt(e[$],n[j](dt)[c]));return n};bt.get_html=function(e,t){var n,i,s,u,f,l,c,p,d,v,y,b,E,S,T;this[a]||(this[a]=this[r].id_start+ ++ft+"_");if(lt[e+N+t+N+this[a]])return lt[e+N+t+N+this[a]];n=(new Date(t,e-1,1)).getDay();n===0&&(n=7);i=new Date(t,e,1),s=new Date(t,e-2,1),u=i[L]()+1,f=i[w](),l=s[L]()+1,c=s[w]();p="<tr>",d=0,v=gt(e,t),y=1;e-1<1?d=gt(12,t-1):d=gt(e-1,t);for(b=1;b<n;b++)p+=D+this[r][o]+R+(d-n+b+1)+q;while(y<=v){if(n>7){p+="</tr><tr>";n=1}E=mt(y,2)+N+mt(e,2)+N+mt(t,4);p+='<td><a class="'+this[r][o]+'_cell" data-date="'+E+'" id="'+this[a]+E+'">'+y+"</a></td>";n++;y++}S=1;while(n<8){p+=D+this[r][o]+R+S++ +q;n++}p+="</tr>";T='<div class="meta"><p class="meta_title"><span>'+this[r].months[e-1]+" "+t+"</span></p>"+_+l+B+c+x+e+C+t+J+this[r][g]+" "+this[r].prev_month_class+G+this[r].prev_month_text+z+_+u+B+f+x+e+C+t+J+this[r][g]+" "+this[r].next_month_class+G+this[r].next_month_text+z+"</div>"+"<table>"+"<thead>"+m+this[r].days[0]+h+m+this[r].days[1]+h+m+this[r].days[2]+h+m+this[r].days[3]+h+m+this[r].days[4]+h+m+this[r].days[5]+h+m+this[r].days[6]+h+"</thead>"+"<tbody>"+p+"</tbody>"+"</table>";lt[e+N+t+N+this[a]]=T;return T};bt.prototype={init:function(){this[O]=e('<div class="'+this[r][o]+'" />');this[s].data("class")&&this[O][d](this[s].data("class"));this[H]=v;this[a]=this[r].id_start+ ++ft+"_";this[u]=".simplecal"+this[a];this[y]=this[s].val();if(this[r][l]){this[Z]();this[O][d](l)}this[r][f]&&st[A]()<=this[r][f]&&this.set_readonly(W);this.events()},events:function(){var t=this;this[s].on("focus click",function(e){t.on_focus(e)}).on(F,function(e){t[b](e)}).on("keyup",function(e){t.on_keyup(e)});this[O].on(et,"."+this[r][o]+"_cell",function(e){t.on_select_date(e,this)});this[O].on(et,"."+this[r][g],function(n){t.on_change_month(n,e(this));return v});this[O].on("show",function(){t.on_show()});this[O].on(Y,function(){t.on_close()})},on_focus:function(){this[rt]()&&this[Z]()},on_keyup:function(t){var n;if(e.inArray(t.keyCode,[37,38,39,40,16,27])>=0)return;if(!this[rt]())return;n=this[s].val()[c]===0?this[i](new Date):this[i](this[s].val());this[O].html(this[p](n[k],n[$]));this[b]()},on_select_date:function(e,t){var n=this[E](this[i](t.id.slice(this[a][c]),"dd-mm-yyyy"));this[s].val(n)[tt](F);this[r][l]||this[Y]()},on_change_month:function(e,t){this[O].html(this[p](t.data("to-month"),t.data("to-year")));this[b]();this[r][l]||this[P]()},on_show:function(){var t=this;this[s][d](this[r][K]);st.on("resize"+this[u],function(){t[r][l]||t[P]()});ot.on(et+this[u]+" focusout"+this[u]+" keyup"+this[u],function(n){var r;if(n.keyCode&&n.keyCode===27&&t[H]){t[Y]();return}r=e(n.target);!r.is(t[s])&&!r.is(t[O])&&!r.parents().is(t[O])&&t[Y]()})},on_close:function(){this[s][M](this[r][K]);ot.off(this[u]);st.off(this[u])},set_readonly:function(e){e?this.element.readOnly=W:this.element.readOnly=v},validate_input:function(){var e=this[s].val();if(e[c]===0||this[i](e)){this[s][M](this[r][o]+nt);this[y]=e;return W}this[s][d](this[r][o]+nt);this[s].val(this[y]);return v},show_calendar:function(){var e;if(this[H])return;this[H]=W;e=this[s].val()[c]===0?this[i](new Date):this[i](this[s].val());this[O].html(this[p](e[k],e[$]));this[b]();if(this[r][l]){if(this[I])return;this[I]=typeof this[r][l]=="string"?this[s].closest(this[r][l]):this[s].parent();this[O].appendTo(this[I])}else{this[O].appendTo(ut);this[P]();this[O][tt]("show")}},close:function(){if(!this[H])return;this[H]=v;this[O].detach()[tt](Y)},setup_markers:function(){var e,t;this[O].find("."+this[r][S])[M](this[r][S]);e=this[i](new Date);this[O].find("#"+this[a]+mt(e.day,2)+N+mt(e[k],2)+N+mt(e[$],2))[d](this[r].date_today_class);if(this[s].val()[c]){t=this[i](this[s].val());this[O].find("#"+this[a]+t.day+N+t[k]+N+t[$])[d](this[r][S])}},setup_position:function(){var e,t,n,i=st[V](),u=st[A](),a=this[s].offset(),l=this[s][V](),c=this[s][A]();if(this[r][f]&&u<=this[r][f]){this.set_readonly(W);this[O].attr("style","")[d](this[r][o]+it).css({top:a.top+l});return}this[O][M](this[r][o]+it);e=this[O][A]();t=this[O][V]();n={};if(e+a.left>u){n.left=a.left-(e-c);n.top=a.top+l}else if(t+a.top>i){n.left=a.left;n.top=a.top-t}else n={left:a.left,top:a.top+l};this[O].css(n)},increment_date:function(e){var t=this[i](this[s].val()),n=new Date(t[$],t[k]-1,t.day);return this.set_date(new Date(n.getTime()+e*864e5))},set_date:function(e,t){this[s].val(this[E](this[i](e,t)))[tt](F);return this},date_valid:function(){},get_date_vars:bt[i],generate_calendar_html:bt.get_html,format_date:bt[E]};e.fn[T]=function(t){return this.each(function(){e.data(this,T)||e.data(this,T,new bt(this,t))})};e[X]=bt;e[X][r]={date_format:"dd.mm.yyyy",attached:v,disable_for_touch_devices:v,mobile_breakpoint:Q,max_date:Q,min_date:Q,calendar_class:T,input_active_class:"active",date_active_class:"selected",date_today_class:"today",month_change_class:"month_control",next_month_class:"next",prev_month_class:"prev",prev_month_text:"Previous month",next_month_text:"Next month",id_start:"sc_",months:["January","February","March","April","May","June","July","August","September","October","November","December"],days:["Mo","Tu","We","Th","Fr","Sa","Su"]}})(jQuery,window,document);