!function($,s,m){"use strict";function e(t,e){this.options=$.extend({},$.simplecal.defaults,e),this.$input=$(t),this.init()}var i=s.app&&s.app.$window||$(s),n=s.app&&s.app.$document||$(m),g=s.app&&s.app.$body||$("body"),u=0,d=Array.prototype.slice,r="scDate-",v=/,|\.|-| |\/|\\/,p=/d/gi,l=/m/gi,h=/y/gi,a=function(s,t){var e={};return t||(t=function(t){return t}),function(){var i=t.apply(this,arguments);return Object.prototype.hasOwnProperty.call(e,i)?e[i]:e[i]=s.apply(this,arguments)}},t=a(function(t,e){return(""+t).length>e?t:Array(e-(""+t).length+1).join("0")+t},function(t,e){return t+":"+e}),o=function(t,e){return new Date(e,t,0).getDate()},f=function(t){var e=new Date(t.year,t.month-1,t.day);return e&&e.getMonth()+1===t.month&&e.getDate()===+t.day},y=a(function(o,a){var t,n=a.match(v)[0],e={},s=o.split(n),i=a.split(n);if(3!==s.length||3!==i.length)return!1;for(t=0;3>t;t++)i[t].match(p)?e.day=parseInt(s[t],10):i[t].match(l)?e.month=parseInt(s[t],10):i[t].match(h)&&(e.year=parseInt(s[t],10));return f(e)?e:!1},function(t,e){return t+":"+e}),c=a(function(s,i,a,n){var e=n;return e=e.replace(/d+/i,t(s,e.match(p).length)),e=e.replace(/m+/i,t(i,e.match(l).length)),e=e.replace(/y+/i,t(a,e.match(h).length))},function(){return d.call(arguments,0).join(":")});e.getDateVars=function(t,e){return t instanceof Date?{day:t.getDate(),month:t.getMonth()+1,year:t.getFullYear()}:(e||(e=this.options.dateFormat),y(t,e))},e.formatDate=function(t,e){return t instanceof Date&&(t={day:t.getDate(),month:t.getMonth()+1,year:t.getFullYear()}),e||(e=this.options.dateFormat),c(t.day,t.month,t.year,e)},e.getHtml=a(function(e,s){var u,l,c,f,g,m,a,d,v,n,h,p,y,C,i=new Date(s,e-1,1).getDay();for(0===i&&(i=7),u=new Date(s,e,1),l=new Date(s,e-2,1),c=u.getMonth()+1,f=u.getFullYear(),g=l.getMonth()+1,m=l.getFullYear(),a="<tr>",d=0,v=o(e,s),n=1,d=1>e-1?o(12,s-1):o(e-1,s),h=1;i>h;h++)a+='<td><span class="'+this.options.cellDisabledClass+'">'+(d-i+h+1)+"</span></td>";for(;v>=n;)i>7&&(a+="</tr><tr>",i=1),p=t(n,2)+"-"+t(e,2)+"-"+t(s,4),a+='<td><a class="'+this.options.cellClass+" "+r+p+'" data-date="'+p+'">'+n+"</a></td>",i++,n++;for(y=1;8>i;)a+='<td><span class="'+this.options.cellDisabledClass+'">'+y++ +"</span></td>",i++;return a+="</tr>",C='<div class="meta"><p class="meta_title"><span>'+this.options.months[e-1]+" "+s+'</span></p><a data-to-month="'+g+'" data-to-year="'+m+'" data-current-month="'+e+'" data-current-year="'+s+'" class="'+this.options.monthChangeClass+" "+this.options.prevMonthClass+'"><span>'+this.options.prevMonthText+'</span></a><a data-to-month="'+c+'" data-to-year="'+f+'" data-current-month="'+e+'" data-current-year="'+s+'" class="'+this.options.monthChangeClass+" "+this.options.nextMonthClass+'"><span>'+this.options.nextMonthText+"</span></a></div><table><thead><th>"+this.options.days[0]+"</th><th>"+this.options.days[1]+"</th><th>"+this.options.days[2]+"</th><th>"+this.options.days[3]+"</th><th>"+this.options.days[4]+"</th><th>"+this.options.days[5]+"</th><th>"+this.options.days[6]+"</th></thead><tbody>"+a+"</tbody></table>"},function(t,e){return t+":"+e}),$.extend(e.prototype,{init:function(){this.$el=$("<div>").addClass(this.options.calendarClass),this.$calEl=$("<div>").addClass(this.options.calendarClass+"Inner").appendTo(this.$el),this.opened=!1,this.ens=".simplecal"+ ++u,this.inputDateValBackup=this.getInputDateVal(),this.options.attached&&(this.showCalendar(),this.$el.addClass(this.options.attachedClass)),this.options.mobileBreakpoint&&i.outerWidth()<=this.options.mobileBreakpoint&&this.setReadonly(!0),this.$input.data("class")&&this.$el.addClass(this.$input.data("class")),this.$input.data("date-format")&&(this.options.dateFormat=this.$input.data("date-format")),this.options.timepicker&&this.setupTimePicker(),this.events()},getInputDateVal:function(){var t=this.$input.val();return t.length?this.options.timepicker?t.split(" ")[0]:t:""},setInputDateVal:function(t){return this.$input.val(this.options.timepicker?t+" "+this.formatTime(parseInt(this.$inputTime.val(),10)):t),this},getInputTimeVal:function(){var t=this.$input.val();return 0!==t.length?t.split(" ")[1]:this.formatTime(0)},setInputTimeVal:function(t){return this.$input.val(this.$input.val().split(" ")[0]+" "+t),this},events:function(){var t="."+this.options.cellClass.split(" ").join("."),e="."+this.options.monthChangeClass.split(" ").join(".");this.$input.on("focus"+this.ens+" click"+this.ens,$.proxy(this.onFocus,this)).on("change"+this.ens,$.proxy(this.setupMarkers,this)).on("keyup"+this.ens,$.proxy(this.onKeyup,this)),this.$el.on("click"+this.ens,t,$.proxy(this.onSelectDate,this)),this.$el.on("click"+this.ens,e,$.proxy(this.onChangeMonth,this)),this.$el.on("show",$.proxy(this.onShow,this)),this.$el.on("close",$.proxy(this.onClose,this))},onFocus:function(){this.validateInput()&&this.showCalendar()},onKeyup:function(e){if(!($.inArray(e.keyCode,[37,38,39,40,16,27])>=0)&&this.validateInput()){var t=this.getDateVars(0===this.getInputDateVal().length?new Date:this.getInputDateVal());this.$calEl.html(this.getCalendarHtml(t.month,t.year)),this.setupMarkers()}},onSelectDate:function(t){var e=this.formatDate(this.getDateVars($(t.target).data("date"),"dd-mm-yyyy"));this.setInputDateVal(e).$input.trigger("change"),this.options.attached||this.close()},onChangeMonth:function(e){var t=$(e.currentTarget);return this.$calEl.html(this.getCalendarHtml(t.data("to-month"),t.data("to-year"))),this.setupMarkers(),this.options.attached||this.setupPosition(),!1},onShow:function(){var t=this;this.$input.addClass(this.options.inputActiveClass),t.options.attached||(i.on("resize"+this.ens,function(){t.setupPosition()}),n.on("click"+this.ens+" focusout"+this.ens+" keyup"+this.ens,function(e){return 27===e.keyCode&&t.opened?void t.close():void(!$(e.target).is(t.$input)&&!$.contains(t.$el[0],e.target)&&t.close())}))},onClose:function(){this.$input.removeClass(this.options.inputActiveClass),n.off(this.ens),i.off(this.ens)},setReadonly:function(t){this.$input[0].readOnly=t},validateInput:function(){var t=this.getInputDateVal();return 0===t.length||this.getDateVars(t)?(this.$input.removeClass(this.options.calendarClass+"_invalid"),this.inputDateValBackup=t,!0):(this.$input.addClass(this.options.calendarClass+"_invalid"),this.options.disableInvalidInput&&this.setInputDateVal(this.inputDateValBackup),!1)},showCalendar:function(){if(!this.opened){this.opened=!0;var t=this.getDateVars(0===this.getInputDateVal().length?new Date:this.getInputDateVal());this.$calEl.html(this.getCalendarHtml(t.month,t.year)),this.setupMarkers(),this.options.attached?this.$attachCont||(this.$attachCont="string"==typeof this.options.attached?this.$input.closest(this.options.attached):this.$input.parent(),this.$el.appendTo(this.$attachCont)):(this.$el.appendTo(g),this.setupPosition(),this.$el.trigger("show"))}},close:function(){this.opened&&(this.opened=!1,this.$el.detach().trigger("close"))},setupMarkers:function(){this.$el.find("."+this.options.dateActiveClass).removeClass(this.options.dateActiveClass);var e=function(e){return"."+r+t(e.day,2)+"-"+t(e.month,2)+"-"+t(e.year,4)};this.$el.find(e(this.getDateVars(new Date))).addClass(this.options.dateTodayClass),this.getInputDateVal().length&&this.$el.find(e(this.getDateVars(this.getInputDateVal()))).addClass(this.options.dateActiveClass)},setupPosition:function(){var s,a,e,h=i.outerHeight(),o=i.outerWidth(),t=this.$input.offset(),n=this.$input.outerHeight(),l=this.$input.outerWidth();return this.options.mobileBreakpoint&&o<=this.options.mobileBreakpoint?(this.setReadonly(!0),void this.$el.attr("style","").addClass(this.options.calendarMobileClass).css({top:t.top+n})):(this.$el.removeClass(this.options.calendarClass+"_mobile"),s=this.$el.outerWidth(),a=this.$el.outerHeight(),e={},s+t.left>o?(e.left=t.left-(s-l),e.top=t.top+n):a+t.top>h?(e.left=t.left,e.top=t.top-a):e={left:t.left,top:t.top+n},void this.$el.css(e))},incrementDate:function(e){var t=this.getDateVars(this.getInputDateVal()),s=new Date(t.year,t.month-1,t.day);return this.setDate(new Date(s.getTime()+864e5*e))},setDate:function(t,e){return this.setInputDateVal(this.formatDate(this.getDateVars(t,e))).$input.trigger("change"),this},setupTimePicker:function(){this.$timeEl=$("<div>").addClass(this.options.timeElClass).appendTo(this.$el),this.$timePreview=$("<div>").addClass(this.options.timePreviewClass).appendTo(this.$timeEl),this.$inputTime=$("<input>").val(this.getInputTimeVal()).appendTo(this.$timeEl).simpleRangeSlider($.extend({maxVal:86399,step:this.options.timeStep,onUpdateView:$.proxy(function(e){var t=this.formatTime(parseInt(e,10));this.$timePreview.text(t),0!==this.$input.val().length&&this.setInputTimeVal(t)},this)},this.options.rangeSliderOptions)).on("change",$.proxy(function(){this.$input.trigger("change")},this)),this.rangeSliderApi=this.$inputTime.data("simpleRangeSlider")},formatTime:function(e){var s=Math.floor(e/3600),i=Math.floor((e-60*s*60)/60),a=e-60*s*60-60*i;return t(s,2)+":"+t(i,2)+(this.options.showSeconds?":"+t(a,2):"")},destroy:function(){this.$input.off(this.ens).removeClass(this.options.inputActiveClass),i.off(this.ens),n.off(this.ens),this.rangeSliderApi&&this.rangeSliderApi.destroy(),this.$el.empty().remove(),delete this.$el.data().simplecal},getDateVars:e.getDateVars,getCalendarHtml:e.getHtml,formatDate:e.formatDate}),$.fn.simplecal=function(t){return this.each(function(){$.data(this,"simplecal")||$.data(this,"simplecal",new e(this,t))})},$.simplecal=e,$.simplecal.defaults={dateFormat:"dd.mm.yyyy",attached:!1,mobileBreakpoint:null,disableInvalidInput:!1,calendarClass:"simplecal",calendarMobileClass:"simplecal_mobile",cellClass:"simplecal_cell",cellDisabledClass:"simplecal_disabled",inputActiveClass:"active",attachedClass:"attached",dateActiveClass:"selected",dateTodayClass:"today",monthChangeClass:"month_control",nextMonthClass:"next",prevMonthClass:"prev",timepicker:!1,timeElClass:"simplecal_time",timePreviewClass:"simplecal_time_preview",timeStep:300,showSeconds:!0,rangeSliderOptions:{},prevMonthText:"Previous month",nextMonthText:"Next month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],days:["Mo","Tu","We","Th","Fr","Sa","Su"]}}(window.jQuery||window.Zepto,window,document);